<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title><span class="caps">DA</span> Homework 5 - <span class="caps">SOLUTION</span></title>
        <link rel="stylesheet" href="../theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../">János K. Divényi </a></h1>
                <nav><ul>
                    <li><a href="../pages/about-me.html">about&nbsp;me</a></li>
                    <li><a href="../pages/research.html">research</a></li>
                    <li><a href="../pages/teaching.html">teaching</a></li>
                    <li><a href="../category/blog.html">blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
    <h1 class="entry-title"><span class="caps">DA</span> Homework 5 - <span class="caps">SOLUTION</span></h1>
    
    <div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>readr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>tidyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>stargazer<span class="p">)</span>
<span class="kn">source</span><span class="p">(</span><span class="s">&#39;~/teaching/BME_adat/201617/code/da_helper_functions.R&#39;</span><span class="p">)</span>
</pre></div>


<h2>Task&nbsp;1</h2>
<p>Download the <code>sample-cohort.csv</code> from the Data section. It contains sample data from the 
National Assessment of Basic Competencies. All of you (who finished high school in Hungary)
had to fulfill this survey in your 6th, 8th and 10th grade. This sample is about
the cohort who started their 6th grade in 2010 (when I graduated from <span class="caps">BME</span>), without
the students in 8-class schools.
The sample contains 8 variables: the id, the type of the school in 8th grade (either primary school or 6-class school, called &#8220;Elite6&#8221;), the math and reading scores from both the 6th and 8th grade, and the education level of the student&#8217;s&nbsp;parents.</p>
<div class="highlight"><pre><span></span>cohort <span class="o">&lt;-</span> read_csv<span class="p">(</span><span class="s">&#39;~/teaching/BME_adat/201617/data/sample_cohort_2010.csv&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Parsed with column specification:
## cols(
##   id = col_double(),
##   school8 = col_character(),
##   math8 = col_double(),
##   reading8 = col_double(),
##   math6 = col_double(),
##   reading6 = col_double(),
##   fed8 = col_character(),
##   med8 = col_character()
## )
</pre></div>


<div class="highlight"><pre><span></span>## 
|=========                                                                      |  11%           
|==========                                                                     |  12%    1 MB
|===========                                                                    |  14%    1 MB
|============                                                                   |  15%    1 MB
|=============                                                                  |  17%    1 MB
|==============                                                                 |  18%    1 MB
|================                                                               |  20%    1 MB
|=================                                                              |  21%    1 MB
|==================                                                             |  23%    1 MB
|===================                                                            |  24%    2 MB
|====================                                                           |  25%    2 MB
|=====================                                                          |  27%    2 MB
|=======================                                                        |  28%    2 MB
|========================                                                       |  30%    2 MB
|=========================                                                      |  31%    2 MB
|==========================                                                     |  33%    2 MB
|===========================                                                    |  34%    2 MB
|============================                                                   |  36%    3 MB
|=============================                                                  |  37%    3 MB
|===============================                                                |  38%    3 MB
|================================                                               |  40%    3 MB
|=================================                                              |  41%    3 MB
|==================================                                             |  43%    3 MB
|===================================                                            |  44%    3 MB
|====================================                                           |  46%    3 MB
|======================================                                         |  47%    4 MB
|=======================================                                        |  49%    4 MB
|========================================                                       |  50%    4 MB
|=========================================                                      |  51%    4 MB
|==========================================                                     |  53%    4 MB
|===========================================                                    |  54%    4 MB
|=============================================                                  |  56%    4 MB
|==============================================                                 |  57%    4 MB
|===============================================                                |  59%    5 MB
|================================================                               |  60%    5 MB
|=================================================                              |  62%    5 MB
|==================================================                             |  63%    5 MB
|===================================================                            |  64%    5 MB
|=====================================================                          |  66%    5 MB
|======================================================                         |  67%    5 MB
|=======================================================                        |  69%    5 MB
|========================================================                       |  70%    5 MB
|=========================================================                      |  72%    6 MB
|==========================================================                     |  73%    6 MB
|============================================================                   |  75%    6 MB
|=============================================================                  |  76%    6 MB
|==============================================================                 |  77%    6 MB
|===============================================================                |  79%    6 MB
|================================================================               |  80%    6 MB
|=================================================================              |  82%    6 MB
|===================================================================            |  83%    7 MB
|====================================================================           |  85%    7 MB
|=====================================================================          |  86%    7 MB
|======================================================================         |  88%    7 MB
|=======================================================================        |  89%    7 MB
|========================================================================       |  90%    7 MB
|=========================================================================      |  92%    7 MB
|===========================================================================    |  93%    7 MB
|============================================================================   |  95%    8 MB
|=============================================================================  |  96%    8 MB
|============================================================================== |  98%    8 MB
|===============================================================================|  99%    8 MB
|================================================================================| 100%    8 MB
</pre></div>


<ul>
<li>How many students went to 6-class schools in the sample? What&nbsp;share?</li>
</ul>
<div class="highlight"><pre><span></span>cohort <span class="o">%&gt;%</span> 
    count<span class="p">(</span>school8<span class="p">)</span> <span class="o">%&gt;%</span>
    mutate<span class="p">(</span>share <span class="o">=</span> n<span class="o">/</span><span class="kp">sum</span><span class="p">(</span>n<span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 2 &lt;U+00D7&gt; 3
##   school8     n      share
##     &lt;chr&gt; &lt;int&gt;      &lt;dbl&gt;
## 1  Elite6  5217 0.06029262
## 2 Primary 81311 0.93970738
</pre></div>


<p>Less than 10 percent of the sample cohort went to 6-class school. We call this type
as elite school because of&nbsp;selectivity.</p>
<ul>
<li>Plot the distribution of math or reading scores in 8th grade by school types.
Which school&#8217;s students perform&nbsp;better?</li>
</ul>
<div class="highlight"><pre><span></span>cohort <span class="o">%&gt;%</span>
    ggplot<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> math8<span class="p">))</span> <span class="o">+</span> 
    geom_density<span class="p">(</span>aes<span class="p">(</span>fill <span class="o">=</span> school8<span class="p">),</span> alpha <span class="o">=</span> <span class="m">0.6</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Warning: Removed 6591 rows containing non-finite values (stat_density).
</pre></div>


<p><img alt="plot of chunk da-homework-5-solution-4" src="../figure/da-homework-5-solution-4-1.png" /></p>
<div class="highlight"><pre><span></span><span class="c1"># More complex plot</span>
cohort <span class="o">%&gt;%</span>
    select<span class="p">(</span>school8<span class="p">,</span> math8<span class="p">,</span> reading8<span class="p">)</span> <span class="o">%&gt;%</span>
    gather<span class="p">(</span>measure<span class="p">,</span> score<span class="p">,</span> <span class="o">-</span>school8<span class="p">)</span> <span class="o">%&gt;%</span>
    ggplot<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> score<span class="p">))</span> <span class="o">+</span> 
    geom_density<span class="p">(</span>aes<span class="p">(</span>fill <span class="o">=</span> school8<span class="p">),</span> alpha <span class="o">=</span> <span class="m">0.6</span><span class="p">)</span> <span class="o">+</span>
    facet_wrap<span class="p">(</span><span class="o">~</span> measure<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Warning: Removed 13133 rows containing non-finite values (stat_density).
</pre></div>


<p><img alt="plot of chunk da-homework-5-solution-5" src="../figure/da-homework-5-solution-5-1.png" /></p>
<p>Students in 6-class schools perform considerably better, than primary school students. This again seems to promote the &#8220;Elite&#8221;&nbsp;naming.</p>
<ul>
<li>Run a regression of 8th grade math score on school types. Interpret the&nbsp;coefficients.</li>
</ul>
<div class="highlight"><pre><span></span>lm1 <span class="o">&lt;-</span> lm<span class="p">(</span>math8 <span class="o">~</span> school8<span class="p">,</span> cohort<span class="p">)</span>
summary_r<span class="p">(</span>lm1<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Loading required package: car
</pre></div>


<div class="highlight"><pre><span></span>## 
## Attaching package: &#39;car&#39;
</pre></div>


<div class="highlight"><pre><span></span>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode
</pre></div>


<div class="highlight"><pre><span></span>## 
## Call:
## lm(formula = math8 ~ school8, data = cohort)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -682.21 -131.42    7.02  138.04  681.79 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    1745.306      2.424  719.90   &lt;2e-16 ***
## school8Primary -151.600      2.532  -59.88   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 197.9 on 79935 degrees of freedom
##   (6591 observations deleted due to missingness)
## Multiple R-squared:  0.03332,    Adjusted R-squared:  0.03331 
## F-statistic:  3586 on 1 and 79935 DF,  p-value: &lt; 2.2e-16
## 
## Number of observations: 79937 
## 
## Note: Heteroscedasticity-consistent standard errors (adjustment HC1)
</pre></div>


<p>Students in 6-class schools have on average score of 1745, 151.6 higher than primary schhol students. This difference is statistically&nbsp;significant.</p>
<ul>
<li>Do you think it shows that elite schools are better? How could you get closer to answer this question? Try to run regressions and interpret what you&nbsp;get.</li>
</ul>
<div class="highlight"><pre><span></span>lm2 <span class="o">&lt;-</span> lm<span class="p">(</span>math8 <span class="o">~</span> school8 <span class="o">+</span> math6<span class="p">,</span> cohort<span class="p">)</span>
lm3 <span class="o">&lt;-</span> lm<span class="p">(</span>math8 <span class="o">~</span> school8 <span class="o">+</span> math6 <span class="o">+</span> reading8<span class="p">,</span> cohort<span class="p">)</span>
lm4 <span class="o">&lt;-</span> lm<span class="p">(</span>math8 <span class="o">~</span> school8 <span class="o">+</span> math6 <span class="o">+</span> reading8 <span class="o">+</span> med8 <span class="o">+</span> fed8<span class="p">,</span> cohort<span class="p">)</span>
stargazer_r<span class="p">(</span><span class="kt">list</span><span class="p">(</span>lm1<span class="p">,</span> lm2<span class="p">,</span> lm3<span class="p">,</span> lm4<span class="p">),</span> digits <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">##</span> 
<span class="err">##</span> <span class="o">========================================================</span>
<span class="err">##</span>                           <span class="nt">Dependent</span> <span class="nt">variable</span><span class="o">:</span>           
<span class="err">##</span>                <span class="nt">-----------------------------------------</span>
<span class="err">##</span>                                  <span class="nt">math8</span>                  
<span class="err">##</span>                  <span class="o">(</span><span class="nt">1</span><span class="o">)</span>       <span class="o">(</span><span class="nt">2</span><span class="o">)</span>        <span class="o">(</span><span class="nt">3</span><span class="o">)</span>        <span class="o">(</span><span class="nt">4</span><span class="o">)</span>    
<span class="err">##</span> <span class="nt">--------------------------------------------------------</span>
<span class="err">##</span> <span class="nt">school8Primary</span>  <span class="nt">-151</span><span class="nc">.6</span>    <span class="nt">-23</span><span class="nc">.1</span>       <span class="nt">3</span><span class="nc">.8</span>        <span class="nt">10</span><span class="nc">.4</span>   
<span class="err">##</span>                <span class="o">(</span><span class="nt">2</span><span class="nc">.5</span><span class="o">)***</span>  <span class="o">(</span><span class="nt">1</span><span class="nc">.7</span><span class="o">)***</span>   <span class="o">(</span><span class="nt">1</span><span class="nc">.6</span><span class="o">)**</span>    <span class="o">(</span><span class="nt">1</span><span class="nc">.7</span><span class="o">)***</span> 
<span class="err">##</span> <span class="nt">math6</span>                      <span class="nt">0</span><span class="nc">.8</span>        <span class="nt">0</span><span class="nc">.4</span>        <span class="nt">0</span><span class="nc">.4</span>    
<span class="err">##</span>                         <span class="o">(</span><span class="nt">0</span><span class="nc">.003</span><span class="o">)***</span> <span class="o">(</span><span class="nt">0</span><span class="nc">.003</span><span class="o">)***</span> <span class="o">(</span><span class="nt">0</span><span class="nc">.004</span><span class="o">)***</span>
<span class="err">##</span> <span class="nt">reading8</span>                              <span class="nt">0</span><span class="nc">.5</span>        <span class="nt">0</span><span class="nc">.4</span>    
<span class="err">##</span>                                    <span class="o">(</span><span class="nt">0</span><span class="nc">.003</span><span class="o">)***</span> <span class="o">(</span><span class="nt">0</span><span class="nc">.004</span><span class="o">)***</span>
<span class="err">##</span> <span class="nt">med8High</span>                                         <span class="nt">25</span><span class="nc">.5</span>   
<span class="err">##</span>                                                <span class="o">(</span><span class="nt">1</span><span class="nc">.9</span><span class="o">)***</span> 
<span class="err">##</span> <span class="nt">med8Secondary</span>                                    <span class="nt">17</span><span class="nc">.4</span>   
<span class="err">##</span>                                                <span class="o">(</span><span class="nt">1</span><span class="nc">.7</span><span class="o">)***</span> 
<span class="err">##</span> <span class="nt">med8Vocational</span>                                   <span class="nt">8</span><span class="nc">.3</span>    
<span class="err">##</span>                                                <span class="o">(</span><span class="nt">1</span><span class="nc">.6</span><span class="o">)***</span> 
<span class="err">##</span> <span class="nt">fed8High</span>                                         <span class="nt">18</span><span class="nc">.4</span>   
<span class="err">##</span>                                                <span class="o">(</span><span class="nt">2</span><span class="nc">.1</span><span class="o">)***</span> 
<span class="err">##</span> <span class="nt">fed8Secondary</span>                                    <span class="nt">11</span><span class="nc">.8</span>   
<span class="err">##</span>                                                <span class="o">(</span><span class="nt">1</span><span class="nc">.9</span><span class="o">)***</span> 
<span class="err">##</span> <span class="nt">fed8Vocational</span>                                   <span class="nt">6</span><span class="nc">.3</span>    
<span class="err">##</span>                                                <span class="o">(</span><span class="nt">1</span><span class="nc">.7</span><span class="o">)***</span> 
<span class="err">##</span> <span class="nt">Constant</span>       <span class="nt">1</span><span class="o">,</span><span class="nt">745</span><span class="nc">.3</span>    <span class="nt">497</span><span class="nc">.4</span>      <span class="nt">219</span><span class="nc">.0</span>      <span class="nt">247</span><span class="nc">.2</span>   
<span class="err">##</span>                <span class="o">(</span><span class="nt">2</span><span class="nc">.4</span><span class="o">)***</span>  <span class="o">(</span><span class="nt">4</span><span class="nc">.7</span><span class="o">)***</span>   <span class="o">(</span><span class="nt">4</span><span class="nc">.4</span><span class="o">)***</span>   <span class="o">(</span><span class="nt">4</span><span class="nc">.9</span><span class="o">)***</span> 
<span class="err">##</span> <span class="nt">--------------------------------------------------------</span>
<span class="err">##</span> <span class="nt">Observations</span>    <span class="nt">79</span><span class="o">,</span><span class="nt">937</span>    <span class="nt">77</span><span class="o">,</span><span class="nt">203</span>     <span class="nt">77</span><span class="o">,</span><span class="nt">196</span>     <span class="nt">63</span><span class="o">,</span><span class="nt">043</span>  
<span class="err">##</span> <span class="nt">R2</span>               <span class="nt">0</span><span class="nc">.03</span>      <span class="nt">0</span><span class="nc">.5</span>        <span class="nt">0</span><span class="nc">.7</span>        <span class="nt">0</span><span class="nc">.7</span>    
<span class="err">##</span> <span class="o">========================================================</span>
<span class="err">##</span> <span class="nt">Note</span><span class="o">:</span>                        <span class="o">*</span><span class="nt">p</span><span class="o">&lt;</span><span class="nt">0</span><span class="nc">.1</span><span class="o">;</span> <span class="o">**</span><span class="nt">p</span><span class="o">&lt;</span><span class="nt">0</span><span class="nc">.05</span><span class="o">;</span> <span class="o">***</span><span class="nt">p</span><span class="o">&lt;</span><span class="nt">0</span><span class="nc">.01</span>
<span class="err">##</span>                    <span class="nt">Robust</span> <span class="nt">standard</span> <span class="nt">errors</span> <span class="nt">in</span> <span class="nt">parentheses</span>
</pre></div>


<p>By gradually including new control variables, the &#8220;effect&#8221; of elite school decreases. When we compare the performance of two students who had the same math score in 6th grade (when both went to primary school), the one who is now a student of an elite school is expected to perform better only by 23 points. Also controlling for the 6th grade reading score, the difference changes sign: primary school student perform better on average than an elite school student with the same 6th grade scores. Controlling for parental education makes this difference even&nbsp;bigger.</p>
<p>We can conclude that it we get no evidence that elite schools are better. They mainly just select better students, that is what explains ther higher performance. As we try to compare similar students there is no difference in their performance, or if any, it is in favor for primary&nbsp;schools.</p>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="">This webpage is still under construction.</a></li>
                            <li><a href="">Please excuse any incoherence or roughness.</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://github.com/divenyijanos">GitHub</a></li>
                            <li><a href="http://hu.linkedin.com/in/janosdivenyi">LinkedIn</a></li>
                            <li><a href="http://stackoverflow.com/users/3409615/janosdivenyi">Stack Overflow</a></li>
                            <li><a href="https://twitter.com/divenyijanos">Twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-85196661-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = 'https://ssl.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
</body>
</html>